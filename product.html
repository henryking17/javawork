<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Product</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Reserve space for the fixed header so the title doesn't get covered */
    .product-page { max-width: 980px; margin: 20px auto; padding: 18px; padding-top: calc(100px + 18px); }
    @media (max-width: 768px) { .product-page { padding-top: calc(120px + 18px); } }
    .product-hero { display:flex; gap:24px; align-items:flex-start; }
    .product-carousel { flex:1; max-width:520px; position:relative; }
    .product-carousel .carousel-track { display:flex; gap:12px; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; padding-bottom:6px; }
    .product-carousel .carousel-item { flex:0 0 90%; max-width:520px; scroll-snap-align:center; border-radius:10px; }
    .product-carousel .carousel-item img { width:100%; height:auto; border-radius:10px; object-fit:cover; display:block; }
    .product-carousel .carousel-btn { position:absolute; top:50%; transform:translateY(-50%); background:rgba(0,0,0,0.45); color:white; border:none; width:44px; height:44px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:10; box-shadow:0 6px 18px rgba(0,0,0,0.12); }
    .product-carousel .carousel-btn.prev { left:8px; }
    .product-carousel .carousel-btn.next { right:8px; }
    /* On small screens, move arrows outside the carousel so they don't cover the product image */
    @media (max-width: 520px) {
      .product-carousel .carousel-btn { width:36px; height:36px; background: rgba(0,0,0,0.28); }
      .product-carousel .carousel-btn.prev { left: -18px; transform: translateY(-50%) translateX(-6px); }
      .product-carousel .carousel-btn.next { right: -18px; transform: translateY(-50%) translateX(6px); }
      .product-carousel .carousel-track { padding-left: 6px; padding-right: 6px; }
    }
    .product-hero img { width:100%; height:auto; border-radius:10px; object-fit:cover; }

    /* Small preview strip under the carousel for quick navigation */
    .image-previews { display:flex; gap:8px; margin-top:10px; justify-content:center; overflow-x:auto; padding-bottom:6px; }
    .image-previews img { width:64px; height:64px; object-fit:cover; border-radius:6px; cursor:pointer; opacity:0.85; border:2px solid transparent; transition: opacity 150ms ease, transform 150ms ease, border-color 150ms ease; }
    .image-previews img.active { opacity:1; border-color:#fff; transform:scale(1.03); box-shadow:0 6px 14px rgba(0,0,0,0.12); }
    @media (max-width:520px){ .image-previews img { width:52px; height:52px; } }
    .product-meta { flex:1; }

    /* Overlay for magnified image */
    .image-overlay { position: fixed; inset:0; background: rgba(0,0,0,0.45); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); opacity: 0; visibility: hidden; display:flex; align-items:center; justify-content:center; z-index:2000; transition: opacity 220ms ease, visibility 220ms ease; pointer-events: none; }
    .image-overlay.open { opacity: 1; visibility: visible; pointer-events: auto; }
    .image-overlay .zoom-container { max-width: 100%; max-height: 100%; overflow: auto; -webkit-overflow-scrolling: touch; touch-action: pan-x pan-y; outline: none; }
    .image-overlay .zoom-container img { display:block; max-width: 90vw; max-height: 90vh; height: auto; border-radius: 6px; margin: 0 auto; cursor: zoom-in; user-select: none; -webkit-user-drag: none; transition: opacity 180ms ease; }
    .image-overlay .zoom-container img.zoomed { cursor: grab; }
    .image-overlay .zoom-container.dragging { cursor: grabbing; }
    .image-overlay .overlay-close { position: absolute; top: 18px; right: 18px; background: rgba(255,255,255,0.08); color: #fff; border: none; width: 40px; height: 40px; border-radius: 8px; font-size: 1.2rem; cursor: pointer; z-index: 2010; }
    .image-overlay .overlay-prev, .image-overlay .overlay-next { position:absolute; top:50%; transform:translateY(-50%); background: rgba(255,255,255,0.06); color:#fff; border:none; width:44px; height:44px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; z-index:2010; }
    .image-overlay .overlay-prev { left: 12px; }
    .image-overlay .overlay-next { right: 12px; }
    @media (max-width:520px){ .image-overlay .overlay-prev, .image-overlay .overlay-next { width:36px; height:36px; } }
    .product-title { font-size:1.6rem; margin:0 0 8px; }
    .product-price { font-size:1.4rem; font-weight:700; color:#C62828; margin-bottom:8px; }
    .qty-controls { display:flex; align-items:center; gap:8px; margin:12px 0; }
    .qty-controls button { width:36px; height:36px; border-radius:6px; }
    .related-carousel { display:flex; gap:12px; overflow-x:auto; padding:12px 6px; margin-top:20px; }
    .related-card { width:180px; min-width:160px; border-radius:8px; background:#fff; padding:8px; box-shadow:0 2px 8px rgba(0,0,0,0.06); cursor:pointer; }
    .related-card img { width:100%; height:110px; object-fit:cover; border-radius:6px; }
    .product-description { margin-top:18px; line-height:1.5; background:#fff; padding:12px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.03); }
    .cta-row { display:flex; gap:10px; margin-top:12px; }
    .view-cart-btn { background:#eee; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; }
  </style>
</head>
<body>
    <header>
        <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"></script>
        <div class="container">
            
            
            <a href="index.html" id="logo-link" aria-label="Home"><img id="logo" src="Copilot_20251226_202609.png" alt="Cympet and Co Logo"></a>
            <nav aria-label="Main navigation">
                <ul id="main-nav" aria-hidden="true">
                    <!-- Mobile search: appears at top of hamburger menu on small screens -->
                    <li class="mobile-search" aria-hidden="true">
                      <form id="mobile-search-form" onsubmit="return false;" class="mobile-search-form">
                        <input id="mobile-search-input" type="text" placeholder="Search products..." aria-label="Search products" class="mobile-search-input">
                        <button id="mobile-search-btn" class="btn mobile-search-btn gold" type="button">Search</button>
                      </form>
                    </li>
                    <li><a href="#contact"><b>Contact Us</b></a></li>
                    <li><a href="#receipts"><b>Receipts</b></a></li>
                    <li><a href="#payment"><b>Payment</b></a></li>
                    <li class="account-dropdown">
                        <button class="account-link dropdown-toggle" aria-haspopup="true" aria-expanded="false"><b>üë§ Account</b></button>
                        <div class="dropdown-menu">
                            <a href="admin.html" class="dropdown-signin">Sign In / Register</a>
                            <button class="dropdown-logout" style="display: none;">Logout</button>
                        </div>
                    </li>
                    <li class="notifications-dropdown">
                        <a id="custNotifAnchor" href="#" role="button" aria-haspopup="true" aria-expanded="false" style="position: relative; display:none;">
                            <b>üîî Notifications</b>
                            <span id="custNotifBadge" style="display: none; position: absolute; top: 50%; transform: translateY(-50%); right: 12px; background: #ef4444; color: white; border-radius: 50%; min-width: 20px; height: 20px; padding: 0 6px; display: inline-flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 700; z-index: 2;"></span>
                        </a>
                        <div id="notifDropdown" class="dropdown" aria-label="Notifications" aria-hidden="true" style="position:absolute; right:0; background:white; color:#111; border:1px solid #e5e7eb; border-radius:8px; min-width:260px; z-index:1000;">
                          <div class="dropdown-inner" style="max-height:300px; overflow-y:auto; padding:10px;">
                            <div class="empty">No notifications</div>
                          </div>
                        </div> 
                    </li> 
                    
                </ul>
            </nav>
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search products...">
                <button id="search-btn" class="btn gold">Search</button>
            </div>

            <!-- Header account icon is injected dynamically on mobile -->

<!-- Mobile header notification removed (moved to in-menu notifications) -->

            <div class="cart-icon" onclick="showCart()">
                üõí <span id="cart-count">0</span>
            </div>
            <button class="hamburger" id="hamburger" aria-controls="main-nav" aria-expanded="false" aria-label="Open menu">‚ò∞</button>
        </div>
    </header>
  <main class="product-page">
    <a href="index.html" style="display:inline-block; margin-bottom:8px;">‚Üê Back to shop</a>
    <div class="product-hero">
      <div class="product-carousel" aria-roledescription="carousel">
        <button class="carousel-btn prev" aria-label="Previous image" type="button">‚Äπ</button>
        <div class="carousel-track" id="prod-carousel" role="list" tabindex="0" aria-label="Product images"></div>
        <div class="image-previews" id="prod-previews" role="list" aria-label="Image previews"></div>
        <button class="carousel-btn next" aria-label="Next image" type="button">‚Ä∫</button>
      </div>
      <div class="product-meta">
        <h1 id="prod-title" class="product-title">Product title</h1>
        <div id="prod-price" class="product-price">‚Ç¶0</div>
        <div id="prod-stock" class="stock-remaining" style="margin-bottom:8px;">In stock: N/A</div>
        <div class="qty-controls">
          <button id="qty-decr" class="btn">‚àí</button>
          <input id="qty-input" type="number" value="1" min="1" style="width:64px;padding:6px;border-radius:6px;border:1px solid #ddd;text-align:center;">
          <button id="qty-incr" class="btn">+</button>
        </div>
        <div class="cta-row">
          <button id="add-to-cart" class="btn primary">Add to cart</button>
          <button id="view-cart" class="view-cart-btn">View cart</button>
        </div>
        <div id="prod-specs" style="margin-top:12px; font-size:0.95rem; color:#333;"></div>
      </div>
    </div>

    <section class="product-description" id="prod-description">
      <!-- Jumia-like description here -->
    </section>

    <h3 style="margin-top:20px;">Related products</h3>
    <div class="related-carousel" id="related-carousel" aria-label="Related products"></div>
  </main>

  <!-- Image overlay for magnified product view (opens when user taps an image) -->
  <div id="imageOverlay" class="image-overlay" aria-hidden="true" role="dialog" aria-label="Image preview">
    <button class="overlay-prev" aria-label="Previous image" type="button">‚Äπ</button>
    <div class="zoom-container" tabindex="0"><img src="" alt=""></div>
    <button class="overlay-next" aria-label="Next image" type="button">‚Ä∫</button>
    <button class="overlay-close" aria-label="Close preview" type="button">√ó</button>
  </div>

  <script src="script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      let sel = null;
      try { sel = JSON.parse(localStorage.getItem('selectedProduct') || 'null'); } catch (e) { sel = null; }
      if (!sel) {
        const params = new URLSearchParams(location.search);
        const key = params.get('key');
        if (key) sel = { key };
      }
      if (!sel || !sel.key) {
        document.getElementById('prod-title').textContent = 'Product not found';
        document.getElementById('prod-description').textContent = '';
        return;
      }

      const key = sel.key;
      const details = getProductDetails(key) || { name: key, description: '', unit_price: 0, priceStr: '‚Ç¶0', image: '' };
      document.getElementById('prod-title').textContent = details.name;
      // Populate carousel images
      const carouselTrack = document.getElementById('prod-carousel');
      if (carouselTrack) {
        let images = [];
        if (details.images && Array.isArray(details.images) && details.images.length) images = details.images.slice();
        else if (details.image) images = [details.image];
        else images = [(sel && sel.image) ? sel.image : 'https://via.placeholder.com/600x400?text=Product'];
        while (images.length < 4) images.push(images[0]);
        carouselTrack.innerHTML = '';
        images.forEach((src, idx) => {
          const item = document.createElement('div');
          item.className = 'carousel-item';
          item.setAttribute('role', 'listitem');
          item.innerHTML = `<img src="${src}" data-idx="${idx}" alt="${details.name} - view ${idx+1}">`;
          carouselTrack.appendChild(item);
        });
        carouselTrack._images = images;
        // Populate thumbnail previews beneath the carousel for quick access
        (function renderPreviews(imgs){
          let previewStrip = document.getElementById('prod-previews');
          const carousel = document.querySelector('.product-carousel');
          if (!previewStrip) {
            previewStrip = document.createElement('div');
            previewStrip.id = 'prod-previews';
            previewStrip.className = 'image-previews';
            previewStrip.setAttribute('role','list');
            if (carousel) carousel.appendChild(previewStrip);
          } else previewStrip.innerHTML = '';
          imgs.forEach((src, idx) => {
            const thumb = document.createElement('img');
            thumb.src = src; thumb.alt = `View ${idx+1}`; thumb.setAttribute('data-idx', idx); thumb.setAttribute('role','button');
            if (idx === 0) thumb.classList.add('active');
            previewStrip.appendChild(thumb);
            thumb.addEventListener('click', (e) => {
              const i = parseInt(e.currentTarget.getAttribute('data-idx'),10);
              const imgEl = carouselTrack.querySelector(`img[data-idx="${i}"]`);
              if (imgEl) imgEl.closest('.carousel-item').scrollIntoView({behavior:'smooth', inline:'center'});
              openImageOverlay(i);
              Array.from(previewStrip.querySelectorAll('img')).forEach((el,j)=>el.classList.toggle('active', j===i));
            });
          });
        })(images);
        const prevBtn = document.querySelector('.product-carousel .carousel-btn.prev');
        const nextBtn = document.querySelector('.product-carousel .carousel-btn.next');
        function scrollByPage(dir = 1) { const delta = Math.round(carouselTrack.clientWidth * 0.9); carouselTrack.scrollBy({ left: dir * delta, behavior: 'smooth' }); }
        if (prevBtn) prevBtn.addEventListener('click', () => scrollByPage(-1));
        if (nextBtn) nextBtn.addEventListener('click', () => scrollByPage(1));
        carouselTrack.addEventListener('keydown', (e) => { if (e.key === 'ArrowRight') { e.preventDefault(); scrollByPage(1); } else if (e.key === 'ArrowLeft') { e.preventDefault(); scrollByPage(-1); } });
      }
      document.getElementById('prod-price').textContent = details.priceStr || formatPrice(details.unit_price || 0);
      document.getElementById('prod-stock').textContent = 'In stock: ' + ((typeof details.stock === 'number') ? details.stock : 'N/A');
      document.getElementById('prod-description').innerHTML = '<strong>Description</strong><p>' + (details.description || '') + '</p>';

      if (details.specs) {
        const specs = details.specs;
        const table = document.createElement('table');
        table.style.width = '100%';
        table.style.borderCollapse = 'collapse';
        let inner = '';
        for (const k in specs) inner += '<tr><td style="padding:6px;border-top:1px solid #eee; width:40%; font-weight:600;">'+k+'</td><td style="padding:6px;border-top:1px solid #eee;">'+specs[k]+'</td></tr>';
        table.innerHTML = inner;
        document.getElementById('prod-specs').appendChild(table);
      }

      const qtyInput = document.getElementById('qty-input');
      const incr = document.getElementById('qty-incr');
      const decr = document.getElementById('qty-decr');
      incr.addEventListener('click', () => { qtyInput.value = Math.max(1, parseInt(qtyInput.value || '1', 10)+1); });
      decr.addEventListener('click', () => { qtyInput.value = Math.max(1, parseInt(qtyInput.value || '1', 10)-1); });

      document.getElementById('add-to-cart').addEventListener('click', () => {
        const qty = Math.max(1, parseInt(qtyInput.value || '1', 10));
        if (typeof addToCartWithQuantity === 'function') addToCartWithQuantity(details.name, qty);
        else { for (let i=0;i<qty;i++) addToCart(details.name); }
      });

      document.getElementById('view-cart').addEventListener('click', () => {
        try { if (typeof showCart === 'function') return showCart(); } catch (e) {}
        try { localStorage.setItem('openCart', '1'); localStorage.setItem('cartReturn', window.location.href); } catch (e) {}
        window.location.href = 'index.html';
      });

      const relatedEntries = (typeof getRelatedProducts === 'function') ? getRelatedProducts(details.name, 12) : (function(){ const arr=[]; for (const k in productCatalog) if (k !== details.name) arr.push({ key:k, data: productCatalog[k] }); return arr.slice(0,12); })();

      const carousel = document.getElementById('related-carousel');
      relatedEntries.forEach(r => {
        const item = r.data || r;
        const rkey = r.key || item.name || '';
        // Resolve authoritative details (handles variants and catalog entries)
        const rd = (typeof getProductDetails === 'function') ? getProductDetails(rkey) : (item || {});
        const img = rd && rd.image ? rd.image : ((item && item.image) || 'https://via.placeholder.com/300x200?text=Img');
        const title = rd && rd.name ? rd.name : (item && (item.name || rkey));
        const price = rd && (rd.priceStr || rd.unit_price) ? (rd.priceStr || formatPrice(rd.unit_price||0)) : (item && (item.priceStr || formatPrice(item.unit_price||0)));

        const card = document.createElement('div');
        card.className = 'related-card';
        card.innerHTML = `<img src="${img}" alt="${title}"><h4 style="font-size:0.95rem;margin:8px 0;">${title}</h4><div style="font-weight:700; color:#C62828;">${price}</div>`;
        card.addEventListener('click', () => {
          try { localStorage.setItem('selectedProduct', JSON.stringify({ key: rkey })); } catch (e) {}
          location.reload();
        });
        carousel.appendChild(card);
      });

      // Image overlay: magnify and make scrollable on click (desktop + mobile friendly) and support carousel navigation
      let _overlayInteractionsSetup = false;
      let overlayImages = [];
      let overlayCurrentIndex = 0;
      function showOverlayImage(index) {
        const overlay = document.getElementById('imageOverlay');
        const img = overlay && overlay.querySelector('.zoom-container img');
        const container = overlay && overlay.querySelector('.zoom-container');
        if (!overlay || !img || !container) return;
        if (!overlayImages || !overlayImages.length) return;
        index = ((index % overlayImages.length) + overlayImages.length) % overlayImages.length;
        overlayCurrentIndex = index;
        // keep preview thumbnails in sync
        const previewStrip = document.getElementById('prod-previews');
        if (previewStrip) Array.from(previewStrip.querySelectorAll('img')).forEach((el,i)=>el.classList.toggle('active', i===overlayCurrentIndex));
        // fade out, swap src, then fade in for a smoother slide feeling
        img.style.transition = 'opacity 180ms ease';
        img.style.opacity = '0';
        setTimeout(() => {
          img.src = overlayImages[index] || '';
          img.alt = (img.src && img.src.indexOf('http') === 0) ? `Image ${index+1}` : img.alt || '';
          img.onload = () => {
            // reset zoom state when switching images
            img.style.width = 'auto'; img.style.maxWidth = '90vw'; img.classList.remove('zoomed');
            container.scrollLeft = Math.max(0, (img.clientWidth - container.clientWidth) / 2);
            container.scrollTop = Math.max(0, (img.clientHeight - container.clientHeight) / 2);
            img.style.opacity = '1';
          };
        }, 120);
      }
      function openImageOverlay(index) {
        const overlay = document.getElementById('imageOverlay');
        const img = overlay && overlay.querySelector('.zoom-container img');
        const container = overlay && overlay.querySelector('.zoom-container');
        if (!overlay || !img || !container) return;
        const track = document.getElementById('prod-carousel');
        overlayImages = (track && track._images) ? track._images.slice() : (img.src ? [img.src] : []);
        if (!overlayImages.length) return;
        overlay.classList.add('open');
        overlay.setAttribute('aria-hidden', 'false');
        document.body.style.overflow = 'hidden';
        showOverlayImage(typeof index === 'number' ? index : 0);
        setupOverlayInteractions();
      }
      function closeImageOverlay() {
        const overlay = document.getElementById('imageOverlay');
        if (!overlay) return;
        overlay.classList.remove('open');
        overlay.setAttribute('aria-hidden', 'true');
        document.body.style.overflow = '';
        const img = overlay.querySelector('.zoom-container img');
        if (img) { img.src = ''; img.style.width = ''; img.style.maxWidth = ''; img.classList.remove('zoomed'); }
      }
      function setupOverlayInteractions() {
        if (_overlayInteractionsSetup) return; _overlayInteractionsSetup = true;
        const overlay = document.getElementById('imageOverlay');
        if (!overlay) return;
        const container = overlay.querySelector('.zoom-container');
        const img = overlay.querySelector('.zoom-container img');
        let lastTap = 0;
        function toggleZoom() {
          if (!img) return;
          const isZoomed = img.classList.contains('zoomed');
          if (!isZoomed) {
            const targetW = Math.max(window.innerWidth * 1.8, img.naturalWidth || 1200);
            img.style.width = targetW + 'px';
            img.style.maxWidth = 'none';
            img.classList.add('zoomed');
            container.scrollLeft = Math.max(0, (img.clientWidth - container.clientWidth) / 2);
            container.scrollTop = Math.max(0, (img.clientHeight - container.clientHeight) / 2);
          } else {
            img.style.width = 'auto';
            img.style.maxWidth = '90vw';
            img.classList.remove('zoomed');
            container.scrollLeft = 0; container.scrollTop = 0;
          }
        }
        img.addEventListener('dblclick', (e) => { e.preventDefault(); toggleZoom(); });
        img.addEventListener('click', (e) => { const now = Date.now(); if (now - lastTap < 300) { e.preventDefault(); toggleZoom(); } lastTap = now; });

        // Drag to pan when zoomed (desktop mouse + touch)
        let isDragging = false, startX = 0, startY = 0, startLeft = 0, startTop = 0;
        // Mouse drag for desktop
        container.addEventListener('mousedown', (ev) => {
          if (!img.classList.contains('zoomed')) return;
          isDragging = true; container.classList.add('dragging'); startX = ev.clientX; startY = ev.clientY; startLeft = container.scrollLeft; startTop = container.scrollTop; ev.preventDefault();
        });
        window.addEventListener('mousemove', (ev) => { if (!isDragging) return; container.scrollLeft = startLeft - (ev.clientX - startX); container.scrollTop = startTop - (ev.clientY - startY); });
        window.addEventListener('mouseup', () => { if (isDragging) { isDragging = false; container.classList.remove('dragging'); } });
        
        // Touch drag for mobile devices (one-finger panning)
        container.addEventListener('touchstart', function(ev) {
          if (!img.classList.contains('zoomed')) return;
          if (!ev.touches || ev.touches.length !== 1) return;
          const t = ev.touches[0];
          isDragging = true; container.classList.add('dragging'); startX = t.clientX; startY = t.clientY; startLeft = container.scrollLeft; startTop = container.scrollTop;
        }, { passive: true });
        container.addEventListener('touchmove', function(ev) {
          if (!isDragging) return;
          if (!ev.touches || ev.touches.length !== 1) return;
          const t = ev.touches[0];
          // calculate movement and scroll
          container.scrollLeft = startLeft - (t.clientX - startX);
          container.scrollTop = startTop - (t.clientY - startY);
          // prevent page from scrolling while panning image
          ev.preventDefault();
        }, { passive: false });
        container.addEventListener('touchend', function(ev) { if (isDragging) { isDragging = false; container.classList.remove('dragging'); } });

        // Swipe-to-navigate (touch & mouse) when NOT zoomed
        let swipe = { startX: 0, startY: 0, startTime: 0, active: false };
        overlay.addEventListener('touchstart', (ev) => {
          if (!ev.touches || ev.touches.length !== 1) return;
          if (img.classList.contains('zoomed')) return; // panning takes precedence when zoomed
          const t = ev.touches[0]; swipe.startX = t.clientX; swipe.startY = t.clientY; swipe.startTime = Date.now(); swipe.active = true;
        }, { passive: true });
        overlay.addEventListener('touchmove', (ev) => {
          if (!swipe.active) return;
          const t = ev.touches[0]; const dx = t.clientX - swipe.startX; const dy = t.clientY - swipe.startY;
          // if primarily horizontal movement, prevent page scroll so swipe feels natural
          if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > 10) ev.preventDefault();
        }, { passive: false });
        overlay.addEventListener('touchend', (ev) => {
          if (!swipe.active) return; swipe.active = false;
          const endX = (ev.changedTouches && ev.changedTouches[0] && ev.changedTouches[0].clientX) || 0;
          const dx = endX - swipe.startX; const dt = Date.now() - swipe.startTime;
          // require a minimum horizontal delta to count as swipe
          if (Math.abs(dx) > 40 && Math.abs(dx) > Math.abs((ev.changedTouches && ev.changedTouches[0] && ev.changedTouches[0].clientY) - swipe.startY)) {
            if (dx > 0) showOverlayImage(overlayCurrentIndex - 1); else showOverlayImage(overlayCurrentIndex + 1);
          }
        });
        // Mouse horizontal swipe for desktop when not zoomed (click-drag)
        let mouseSwipe = { active: false, startX: 0 };
        overlay.addEventListener('mousedown', (ev) => {
          if (img.classList.contains('zoomed')) return; mouseSwipe.active = true; mouseSwipe.startX = ev.clientX; ev.preventDefault();
        });
        window.addEventListener('mousemove', (ev) => {
          if (!mouseSwipe.active) return; const dx = ev.clientX - mouseSwipe.startX; if (Math.abs(dx) > 40) { mouseSwipe.active = false; if (dx > 0) showOverlayImage(overlayCurrentIndex - 1); else showOverlayImage(overlayCurrentIndex + 1); }
        });
        window.addEventListener('mouseup', () => { mouseSwipe.active = false; });

        // Prev/next overlay navigation
        const prevBtn = overlay.querySelector('.overlay-prev');
        const nextBtn = overlay.querySelector('.overlay-next');
        if (prevBtn) prevBtn.addEventListener('click', (e) => { e.stopPropagation(); showOverlayImage(overlayCurrentIndex - 1); });
        if (nextBtn) nextBtn.addEventListener('click', (e) => { e.stopPropagation(); showOverlayImage(overlayCurrentIndex + 1); });

        // Close overlay on click outside / close button / ESC; left/right arrows navigate
        overlay.querySelector('.overlay-close').addEventListener('click', closeImageOverlay);
        document.addEventListener('click', (e) => { if (e.target === overlay) closeImageOverlay(); });
        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeImageOverlay(); else if (e.key === 'ArrowLeft') showOverlayImage(overlayCurrentIndex - 1); else if (e.key === 'ArrowRight') showOverlayImage(overlayCurrentIndex + 1); });
      }
      // Attach click handlers to carousel images (delegated)
      const track = document.getElementById('prod-carousel');
      if (track) {
        track.addEventListener('click', (e) => {
          const img = e.target.closest && e.target.closest('img');
          if (img) {
            const idx = img.getAttribute('data-idx');
            openImageOverlay(idx ? parseInt(idx, 10) : 0);
          }
        });
      }


    });
  </script>

    <footer class="site-footer">
      <div class="footer-top">
        <div class="container footer-top-inner">


          <!-- Apps/social removed as requested -->
        </div>
      </div>

      <div class="footer-middle">
        <div class="container footer-columns">


          <div class="footer-column">
            <h5>Customer Care</h5>
            <ul>
              <li><a href="#contact">Contact Us</a></li>
              <li><a href="#payment">Payment Options</a></li>
              <li><a href="#about">About Us</a></li>
              <li><a href="#receipts">My Receipts</a></li>
            </ul>
          </div>

          <div class="footer-column">
            <h5>Help</h5>
            <ul>
              <li><a href="#contact">FAQ</a></li>
              <li><a href="#contact">Shipping & Delivery</a></li>
              <li><a href="#contact">Returns</a></li>
            </ul>
          </div>

          <div class="footer-column">
            <h5>Legal & Info</h5>
            <ul>
              <li><a href="legal.html#privacy">Privacy Policy</a></li>
              <li><a href="legal.html#terms">Terms of Use</a></li>
              <li><a href="legal.html#security">Security</a></li>
            </ul>
          </div>

          <div class="footer-column contact-col">
            <h5>Contact</h5>
            <p>üìç No 41, Shogbamu Street, Lagos State</p>
            <p>üìû 0803 309 0515 ‚Ä¢ 0912 513 6183<!-- original: +234 803 309 0515 ‚Ä¢ +234 912 513 6183 --></p>
            <p>üìß cympet2017@gmail.com</p>
          </div>
        </div>
      </div>

      <div class="footer-bottom">
        <div class="container footer-bottom-inner">
          <div class="payments">Accepted payments: <span class="payment-icons">Visa ‚Ä¢ Mastercard ‚Ä¢ Paystack</span></div>
          <div class="copyright">&copy; 2025 Cympet and Co. Enterprises. All rights reserved.</div>
          <!-- Persistent cookie settings button (visible and usable) -->
          <div style="display:flex; align-items:center; gap:8px;">
            <button id="open-cookie-manager" class="cookie-manage-btn" style="display:inline-block;" aria-controls="cookie-consent" aria-haspopup="dialog" aria-label="Open cookie settings">Cookie settings</button>
            <span id="cookie-status-badge" class="cookie-status-badge disabled" aria-live="polite" title="Cookie and analytics status">Cookies: Off</span>
          </div>
        </div>
      </div>
    </footer>

</body>
</html>